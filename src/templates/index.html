<div id="ng-ovh-chatbot">
    <ng-include src="'ng-ovh-chatbot-icons-template.html'"></ng-include>

    <div class="chatbot-main"
         data-ng-hide="ctrl.hidden"
         data-ng-if="ctrl.options.enable">
        <div class="chatbot-header">
            <h6>OVH Chat</h6>
        </div>
        <div class="chatbot-body">
            <div class="chatbot-messages">
                <div class="chatbot-message"
                    data-ng-repeat="message in ctrl.messages track by $index"
                    data-ng-if="message.type !== ctrl.MESSAGE_TYPES.postback"
                    data-ng-class="{'chatbot-message-user': message.type === ctrl.MESSAGE_TYPES.user,
                                    'chatbot-message-bot': message.type !== ctrl.MESSAGE_TYPES.user}">
                    <div class="chatbot-avatar" data-ng-if="message.type === ctrl.MESSAGE_TYPES.bot"></div>
                    <div class="chatbot-time" data-ng-bind="message.time"></div>
                    <div class="chatbot-text">
                        <ng-embed data-embed-data="message.text"
                                data-embed-template-url="ng-ovh-chatbot-embedded-template.html"
                                data-embed-options="ctrl.NG_EMBED_OPTIONS">
                        </ng-embed>
                    </div>
                </div>
            </div>
        </div>
        <div class="chatbot-footer">
            <form data-ng-submit="ctrl.ask()">
                <textarea name="message"
                        rows="1"
                        autofocus="autofocus"
                        placeholder="Votre message..."
                        data-ng-model="ctrl.message"
                        data-ng-keyup="$event.keyCode == 13 && ctrl.ask()"
                        data-ng-disabled="!ctrl.messages.length"></textarea>
                <button type="submit"
                        value="Ok"
                        data-ng-disabled="!ctrl.messages.length || !ctrl.message.length">
                </button>
            </form>
        </div>
    </div>

    <div class="chatbot-open" ng-hide="!ctrl.hidden || (ctrl.error && !ctrl.messages.length)" ng-if="ctrl.options.enable">
        <span class="chatbot-notification oui-paragraph" aria-hidden="true" ng-hide="!ctrl.newMsg">{{ctrl.newMsg > 9 ? '+' : ctrl.newMsg}}</span>
        <div class="oui-loader oui-loader_s" ng-if="!ctrl.messages.length && ctrl.initialized && !ctrl.error">
            <div class="oui-loader__container chatbot-loader">
                <div class="oui-loader__image"></div>
            </div>
        </div>
        <button class="chatbot-icon_wrapper" ng-if="ctrl.messages.length || !ctrl.initialized" ng-click="ctrl.open()" type="button">
            <div class="chatbot-icon" aria-hidden="true">
            </div>
        </button>
    </div>

</div>
